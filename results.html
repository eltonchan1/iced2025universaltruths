<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ICED 2025: Results</title>
<script type="text/javascript">
function MM_swapImgRestore() {
  var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++) x.src=a[i].oSrc;
}
function MM_preloadImages() {
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}
function MM_findObj(n, d) {
  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x && d.getElementById) x=d.getElementById(n); return x;
}
function MM_swapImage() {
  var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array;
  for(i=0;i<(a.length-2);i+=3)
   if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc) x.oSrc=x.src; x.src=a[i+2];}
}
</script>
<style type="text/css">
h1, h2, h3, h4, h5, h6, body, td, th, a:link, a:visited, a:active {
	color: #FFFFFF;
}
a:hover {
	text-decoration: underline;
	color: #FFFFFF;
}
</style>
</head>
<center>
<body background="Images/backgroundig225.png" onLoad="MM_preloadImages('Images/homeon.png','Images/abouton.png','Images/resultson.png','Images/surveyon.png')">
<table width="1200" border="0" cellspacing="0" cellpadding="0">
  <tbody>
    <tr>
      <td height="102" colspan="6"><img src="Images/header.png" width="1200" height="100" alt=""/></td>
    </tr>
    <tr>
      <td width="292" height="52">&nbsp;</td>
      <td width="147"><a href="index.html" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image3','','Images/homeon.png',1)"><img src="Images/homeoff.png" alt="" width="146" height="50" id="Image3"></a></td>
      <td width="147"><a href="about.html" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image7','','Images/abouton.png',1)"><img src="Images/aboutoff.png" alt="" width="146" height="50" id="Image7"></a></td>
      <td width="146"><a href="survey.html" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image10','','Images/surveyon.png',1)"><img src="Images/surveyoff.png" alt="" width="146" height="50" id="Image10"></a></td>
      <td width="148"><a href="#" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image6','','Images/resultson.png',1)"><img src="Images/resultsoff.png" alt="" width="146" height="50" id="Image6"></a></td>
      <td width="310">&nbsp;</td>
    </tr>
    <tr>
      <td colspan="6"><img src="Images/hero image.png" width="1200" height="400" alt=""/></td>
    </tr>
  </tbody>
</table>
<h1>Results of the Survey!</h1>

<!-- ▼▼▼ Live Google Sheets Results Display ▼▼▼ -->
<table id="responseTable" style="color:white; width: 1000px; border-collapse: collapse; margin-top: 20px;">
  <thead></thead>
  <tbody></tbody>
</table>
<script>
  const SHEET_ID = '1iBmJhzh4XKOxyfN8jNdtVAFqrlGccsn9UAjbeQD_UtA';
  const API_KEY = 'AIzaSyB4Kvq4D4lUtuH_Ddo1moAeB5K2FbwIMyc';
  const RANGE = 'ICED%20survey%20(Responses)';

  async function fetchData() {
    const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${RANGE}?key=${API_KEY}`;
    const response = await fetch(url);
    const data = await response.json();

    if (!data.values) return;

    const [headers, ...rows] = data.values;
    const thead = document.querySelector("#responseTable thead");
    const tbody = document.querySelector("#responseTable tbody");

    thead.innerHTML = "<tr>" + headers.map(h => `<th style="border:1px solid white; padding:5px;">${h}</th>`).join('') + "</tr>";
    tbody.innerHTML = rows.map(row => 
      `<tr>${headers.map((_, i) => `<td style="border:1px solid white; padding:5px;">${row[i] || ''}</td>`).join('')}</tr>`
    ).join('');
  }

  fetchData();
  setInterval(fetchData, 10000); // Update every 10 seconds
</script>
<!-- ▲▲▲ End of Google Sheets Script ▲▲▲ -->

<table width="1200" border="0" cellspacing="0" cellpadding="0" style="margin-top: 50px;">
  <tbody>
    <tr>
      <td width="200"><a href="about.html"><img src="Images/world200.png" width="200" height="200" alt=""/></a></td>
      <td width="400"><a href="about.html">
        <h2>About Us</h2>
        <p>Who are we and why did we do this?</p>
      </a></td>
      <td width="200"><a href="survey.html"><img src="Images/survey200.png" width="200" height="200" alt=""/></a></td>
      <td width="400"><a href="survey.html">
        <h2>Take the Survey</h2>
        <p>Take our survey to help support our research!</p>
      </a></td>
    </tr>
  </tbody>
</table>
<p><img src="Images/footer.png" alt="" width="1200" height="157" usemap="#Map"/>
  <map name="Map">
    <area shape="circle" coords="498,79,27" href="https://docs.google.com/forms/d/e/1FAIpQLSc3th9ICOlK5Ob-6Y3sxbJMXkPmQHDXdZTs-3N02eBvQRNMdQ/viewform?usp=sharing&ouid=118029755189425548535" target="_blank" alt="">
    <area shape="circle" coords="704,80,25" href="https://www.instagram.com/universaltruths.2025/" target="_blank">
  </map>
</p>
<p>&nbsp;</p>
</body>
</center>
</html>
